
<!doctype html>
<html>
<head>
	<title>iOS 6 Web Audio Scirra test (v3)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />

	<script src="jquery-2.1.4.js"></script>
	
	<script>
	(function () {
		var context = null;
		var buffer1 = null, buffer2 = null;
		
		function addStatus1(msg) {
			jQuery("#status1").append("<br/>" + msg);
		};
		
        function addStatus2(msg) {
			jQuery("#status2").append("<br/>" + msg);
		};
        
		window.onerror = function(errorMsg, url, lineNumber) {
			addStatus1("JAVASCRIPT ERROR: " + errorMsg + " (" + url + ", line " + lineNumber + ")");
		};
        
//		window.onerror2 = function(errorMsg, url, lineNumber) {
//			addStatus2("JAVASCRIPT ERROR: " + errorMsg + " (" + url + ", line " + lineNumber + ")");
//		};
        
        
		function decodeError1() {
			addStatus1("Error in decodeAudioData");
		};
		
        function decodeError2() {
			addStatus2("Error in decodeAudioData");
		};
        
        
		function playSound1(when_) {
			
            
            if (!buffer1)
				return;
			
			var source = context.createBufferSource();
			source.buffer = buffer1;
			source.connect(context.destination);
			source.noteOn(when_);
		};
		
        function playSound2(when_) {
			if (!buffer2)
				return;
			
			var source = context.createBufferSource();
			source.buffer = buffer2;
			source.connect(context.destination);
			source.noteOn(when_);
		};
        
        
		jQuery(document).ready(function () {
			if (typeof AudioContext !== "undefined")
			{
				context = new AudioContext();
				addStatus1("Created AudioContext");
			}
			else if (typeof webkitAudioContext !== "undefined")
			{
				context = new webkitAudioContext();
				addStatus1("Created webkitAudioContext");
			}
			else
			{
				addStatus1("Web Audio API does not appear to be supported");
				return;
			}
			
			// AJAX request sound
            
			var request1 = new XMLHttpRequest();
			request1.open("GET", "8notesDiatoAmV4A3.mp3", true);
			request1.responseType = "arraybuffer";
			request1.onload = function () {
				addStatus1("A3.mp3 loaded, decoding...");
				context.decodeAudioData(request1.response, function (buffer_) {
					addStatus1("Finished decoding audio");
					buffer1 = buffer_;
				}, decodeError1);
			};
			request1.send();
            
            
            
            var request2 = new XMLHttpRequest();
			request2.open("GET", "8notesDiatoAmV4A4.mp3", true);
			request2.responseType = "arraybuffer";
			request2.onload = function () {
				addStatus2("B3.mp3 loaded, decoding...");
				context.decodeAudioData(request2.response, function (buffer_) {
					addStatus2("Finished decoding audio");
					buffer2 = buffer_;
				}, decodeError2);
			};
			request2.send();
            
			
			jQuery("#play1").click(function() {
				//setTimeout(1000, function() {
					playSound1(0);
				//});
			});
            
            jQuery("#play2").click(function() {
				//setTimeout(1000, function() {
					playSound2(0);
				//});
			});
            
		});
	})();
	</script>
</head>
<body>
	<button id="play1" data-sound="8notesDiatoAmV4A3.mp3">A3</button>
	<p id="status1">Status:</p>
    
    <button id="play2" data-sound="8notesDiatoAmV4B3.mp3">B3</button>
	<p id="status2">Status:</p>
    <p>test 8</p>
</body>
</html>